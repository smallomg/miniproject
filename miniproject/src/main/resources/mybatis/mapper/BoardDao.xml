<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.dao.IBoardDao">
	<!-- QnA 등록 -->
	<insert id="insertQna"
		parameterType="com.example.demo.dto.QnaDTO">
		INSERT INTO QNA (qno, id, qtitle, qcontent, qdate,
		qstatus, qtype)
		VALUES (
		'Q' || LPAD(seq_qna.NEXTVAL, 3, '0'),
		#{id},
		#{qtitle}, #{qcontent}, #{qdate}, #{qstatus}, #{qtype}
		)
	</insert>

	<!-- QnA 목록 조회 -->
	<select id="selectQnaList"
		resultType="com.example.demo.dto.QnaDTO">
		SELECT qno, id, qtitle, qcontent, qanswer, qdate, qstatus,
		qtype
		FROM QNA
		WHERE id = #{id}
		ORDER BY qdate DESC
	</select>

	<!-- QnA 상세 조회 -->
	<select id="selectQnaByQno" parameterType="String"
		resultType="com.example.demo.dto.QnaDTO">
		SELECT qno, id, qtitle, qcontent,qanswer, qdate, qstatus,
		qtype
		FROM QNA
		WHERE qno = #{qno}
	</select>

	<!-- FAQ 목록 조회 -->
	<select id="selectFaqList" resultType="com.example.demo.dto.FaqDTO">
		SELECT fno, ftitle, fcontent FROM FAQ
	</select>

	<select id="selectNoticeList" resultType="com.example.demo.dto.NoticeDTO">
		SELECT * FROM notice
	</select>


	<!-- ============================ 관리자=============================== -->
	<!-- 관리자 Qna 답변 -->
	<update id="updateAnswer"
		parameterType="com.example.demo.dto.QnaDTO">
		UPDATE QNA
		SET qanswer = #{qanswer}, qstatus = #{qstatus}
		WHERE qno = #{qno}
	</update>

	<!-- 관리자 FAQ 등록-->
	<insert id="insertFaq" parameterType="com.example.demo.dto.FaqDTO">
		INSERT INTO FAQ (fno, ftitle, fcontent) VALUES('F' || LPAD(seq_qna.NEXTVAL, 3, '0'),
		#{ftitle}, #{fcontent}
		)
	</insert>
	
	<!-- 관리자 FAQ 삭제-->
	<delete id="deleteFaq">
		DELETE FROM FAQ WHERE fno=#{fno}
	</delete>
	
	<!-- 관리자 공지사항 등록-->
	<insert id="insertNotice" parameterType="com.example.demo.dto.NoticeDTO">
		INSERT INTO notice (nid, ntitle, ncontent, ndate)
		VALUES('N' || LPAD(seq_notice.NEXTVAL, 3, '0'),
		#{ntitle}, #{ncontent}, #{ndate}
		)
	</insert>
	
	<!--  관리자 QNA 대기 작업 확인-->
	<select id="selectQnaByQstatus" resultType="com.example.demo.dto.QnaDTO">
		SELECT qno, id, qtitle, qcontent,qanswer, qdate, qstatus,
		qtype
		FROM QNA
		WHERE qstatus = '대기'
	</select>
	
	<!-- 관리자 Notice 삭제 -->
	<delete id="deleteNotice">
		DELETE FROM notice WHERE nid=#{nid}
	</delete>
	

</mapper>
